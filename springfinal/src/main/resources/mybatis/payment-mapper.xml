<?xml version="1.0" encoding="UTF-8"?>

	<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
    <mapper namespace="payment">
    	<select id="sequence" resultType="int">
    		select payment_seq.nextval from dual
    	</select>
    	
    	<insert id="insert">
    		insert into payment(
    			payment_no,payment_member,payment_product,payment_tid,
    			payment_name,payment_price,payment_remain,payment_status
    		)
    		values(
    			#{paymentNo},#{paymentMember},#{paymentProduct},#{paymentTid},
    			#{paymentName},#{paymentPrice},#{paymentRemain},'완료'
    		)
    	</insert>
    	
    	<!-- 목록 -->
    	<select id="list" resultType="PaymentDto">
    		select * from payment order by payment_no asc
    	</select>
    	
    	<!-- 상세조회 -->
    	<select id="find" resultType="PaymentDto">
    		select * from payment where payment_no = #{paymentNo}
    	 </select>
    	 
    	 <!-- payment 잔여금액처리 -->
    	 <update id="cancel">
    	 	update payment
    	 	set payment_status = '취소'
    	 	where payment_no = #{paymentNo}
    	 </update>
    	
    	<resultMap type="PaymentListVO" id="paymentListVO">
    		<!-- 일단 조회 결과는 내가 지정한 객체에 필드에 맞게 배치해라! -->
    		<association property="paymentDto">
    			<result column="payment_no" property="paymentNo"/>
    			<result column="payment_member" property="paymentMember"/>
    			<result column="payment_Product" property="paymentProduct"/>
    			<result column="payment_tid" property="paymentTid"/>
    			<result column="payment_name" property="paymentName"/>
    			<result column="payment_price" property="paymentPrice"/>
    			<result column="payment_remain" property="paymentRemain"/>
    			<result column="payment_time" property="paymentTime"/>
    			<result column="payment_status" property="paymentStatus"/>
    		</association>
    		</resultMap>
    </mapper>